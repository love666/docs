{"files":{"index.html":{"content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <link rel=\"stylesheet\" href=\"//unpkg.com/@logicflow/core/dist/style/index.css\" />\n  <link rel=\"stylesheet\" href=\"./style.css\" />\n  <style>\n    html, body {\n      height: 100%;\n      margin: 0;\n      padding: 0;\n    }\n    #container {\n      height: calc(100% - 20px);\n      width: 100%;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"container\"></div>\n  <script src=\"//unpkg.com/@logicflow/core/dist/logic-flow.js\"></script>\n  <script src=\"https://cdn.staticfile.org/react/16.4.0/umd/react.development.js\"></script>\n  <script src=\"https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js\"></script>\n  <script type=\"module\" src=\"./index.js\"></script>\n</body>\n</html>"},"index.js":{"content":"import reactNode from \"./reactNode.js\";\n\n// logicflow流程图配置\nconst LFConfig = {\n  edgeTextDraggable: true,\n  adjustEdgeMiddle: true,\n  hoverOutline: false,\n  nodeSelectedOutline: false,\n  hideAnchors: true,\n  background: {\n    backgroundImage:\n            \"url('https://dpubstatic.udache.com/static/dpubimg/805efa14-d908-4332-a7a2-bee8fbb903e3.jpg')\",\n    backgroundRepeat: 'repeat',\n  },\n  grid: {\n    size: 1,\n    visible: false,\n  },\n  keyboard: {\n    enabled: true,\n  },\n};\nconst container = document.querySelector('#container');\n\nconst lf = new LogicFlow({\n  ...LFConfig,\n  // 容器\n  container,\n  // 指定画布区域的宽高，默认使用容器宽高\n  width: 1000,\n  height: 1000,\n});\n\nlf.register(reactNode);\n\nlf.on('custom:add-one', (model) => {\n  lf.setProperties(model.id, {\n    name: 'reactComponent',\n    body: model.getProperties().body + 1,\n  });\n});\n\nlf.on('custom:delete-one', (model) => {\n  lf.setProperties(model.id, {\n    name: 'reactComponent',\n    body: model.getProperties().body - 1,\n  });\n});\n\nconst nodeData = {\n  id: \"1\",\n  type: \"react-node\",\n  x: 300,\n  y: 250,\n  properties: {\n    name: \"hello\",\n    body: Math.random(),\n  }\n};\n\nconst render = (node) => {\n  lf.render({\n    nodes: [\n      node,\n    ]\n  });\n}\nrender(nodeData);"},"reactComponent.jsx":{"content":"function Hello(props) {\n  const addOne = () => {\n    props.graphModel.eventCenter.emit(\"custom:add-one\", props.model);\n  }\n\n  const deleteOne = () => {\n    props.graphModel.eventCenter.emit(\"custom:delete-one\", props.model);\n  }\n\n  return (\n    <div className=\"uml-wrapper\">\n      <div className=\"uml-head\">Head</div>\n      <div className=\"uml-body\">\n        <div><button onClick={() => addOne()}>+</button> <button onClick={() => deleteOne()}>-</button>    {props.name}</div>\n        <div>{props.body}</div>\n      </div>\n      <div className=\"uml-footer\">\n        <div>setHead(Head $head)</div>\n        <div>setBody(Body $body)</div>\n      </div>\n    </div>\n  )\n}\n\nexport default Hello;\n"},"reactNode.jsx":{"content":"import Hello from \"./reactComponent.js\";\n\nclass CustomReactNodeModel extends HtmlNodeModel {\n  setAttributes() {\n    this.text.editable = false; // 禁止节点文本编辑\n    // 设置节点宽高和锚点\n    const width = 200;\n    const height = 130;\n    this.width = width;\n    this.height = height;\n    this.anchorsOffset = [\n      [width / 2, 0],\n      [0, height / 2],\n      [-width / 2, 0],\n      [0, -height/2],\n    ]\n  }\n}\n\nclass CustomReactNode extends HtmlNode {\n  setHtml(rootEl) {\n    const { properties } = this.props.model;\n    ReactDOM.render(\n      <Hello\n        name={properties.name}\n        body={properties.body}\n        graphModel={this.props.graphModel}\n        model={this.props.model}\n      />,\n      rootEl\n    );\n  }\n}\n\nexport default {\n  type: 'react-node',\n  view: CustomReactNode,\n  model: CustomReactNodeModel,\n}"},"style.css":{"content":"\n.uml-wrapper {\n  background: #68fce2;\n  width: 100%;\n  height: 100%;\n  border-radius: 10px;\n  border: 2px solid #838382;\n  box-sizing: border-box;\n}\n.uml-head {\n  text-align: center;\n  line-height: 30px;\n  font-size: 16px;\n  font-weight: bold;\n}\n.uml-body {\n  border-top: 1px solid #838382;\n  border-bottom: 1px solid #838382;\n  padding: 5px 10px;\n  font-size: 12px;\n}\n.uml-footer {\n  padding: 5px 10px;\n  font-size: 14px;\n}\n"}}}